<div class="admin-container">
  <div class="admin-header">
    <div class="header-content">
      <div class="header-text">
        <h1>–ö–∞–±–∏–Ω–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
        <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ currentUser?.username }}!</p>
      </div>
      <button class="exit-btn" (click)="exitAdmin()">
        <span class="exit-icon">üö™</span>
        –í—ã–π—Ç–∏ –∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞
      </button>
    </div>
  </div>

  <!-- –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–∫–µ–Ω–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) -->
  <div class="debug-info" *ngIf="showDebugInfo">
    <h3>üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–∫–µ–Ω–µ</h3>
    <div class="debug-grid">
      <div class="debug-item">
        <strong>–¢–æ–∫–µ–Ω:</strong>
        <code>{{ authService.getToken() | slice:0:50 }}...</code>
      </div>
      <div class="debug-item">
        <strong>–†–æ–ª—å –∏–∑ —Ç–æ–∫–µ–Ω–∞:</strong>
        <span class="debug-value">{{ authService.getRoleFromToken() || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ' }}</span>
      </div>
      <div class="debug-item">
        <strong>ID –∏–∑ —Ç–æ–∫–µ–Ω–∞:</strong>
        <span class="debug-value">{{ authService.getUserIdFromToken() || '–ù–µ –Ω–∞–π–¥–µ–Ω–æ' }}</span>
      </div>
      <div class="debug-item">
        <strong>–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</strong>
        <pre class="debug-json">{{ authService.getTokenInfo() | json }}</pre>
      </div>
    </div>
    <button class="debug-toggle" (click)="toggleDebugInfo()">
      {{ showDebugInfo ? '–°–∫—Ä—ã—Ç—å' : '–ü–æ–∫–∞–∑–∞—Ç—å' }} –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    </button>
  </div>

  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–∞–º -->
  <div class="admin-tabs">
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'dashboard'"
      (click)="setActiveTab('dashboard')"
    >
      üìä –î–∞—à–±–æ—Ä–¥
    </button>
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'orders'"
      (click)="setActiveTab('orders')"
    >
      üì¶ –ó–∞–∫–∞–∑—ã
    </button>
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'users'"
      (click)="setActiveTab('users')"
    >
      üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
    </button>
    <button 
      class="tab-btn" 
      [class.active]="activeTab === 'products'"
      (click)="setActiveTab('products')"
    >
      üõçÔ∏è –¢–æ–≤–∞—Ä—ã
    </button>
  </div>

  <!-- –î–∞—à–±–æ—Ä–¥ -->
  <div *ngIf="activeTab === 'dashboard'" class="tab-content dashboard-tab">
    <h2>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon">üë•</div>
        <div class="stat-content">
          <h3>{{ stats.totalUsers }}</h3>
          <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">üõçÔ∏è</div>
        <div class="stat-content">
          <h3>{{ stats.totalProducts }}</h3>
          <p>–¢–æ–≤–∞—Ä–æ–≤</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">üì¶</div>
        <div class="stat-content">
          <h3>{{ stats.totalOrders }}</h3>
          <p>–ó–∞–∫–∞–∑–æ–≤</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">üí∞</div>
        <div class="stat-content">
          <h3>{{ formatPrice(stats.totalRevenue) }}</h3>
          <p>–û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞</p>
        </div>
      </div>
      
      <div class="stat-card warning">
        <div class="stat-icon">‚è≥</div>
        <div class="stat-content">
          <h3>{{ stats.pendingOrders }}</h3>
          <p>–û–∂–∏–¥–∞—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏</p>
        </div>
      </div>
      
      <div class="stat-card danger">
        <div class="stat-icon">‚ö†Ô∏è</div>
        <div class="stat-content">
          <h3>{{ stats.lowStockProducts }}</h3>
          <p>–ù–∏–∑–∫–∏–π –∑–∞–ø–∞—Å</p>
        </div>
      </div>
    </div>

    <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
    <div class="quick-actions">
      <h3>–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
      <div class="actions-grid">
        <button class="action-btn" (click)="goToProducts()">
          <span class="action-icon">üõçÔ∏è</span>
          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
        </button>
        <button class="action-btn" (click)="goToOrders()">
          <span class="action-icon">üì¶</span>
          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏
        </button>
        <button class="action-btn" (click)="goToUsers()">
          <span class="action-icon">üë•</span>
          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
        </button>
        <button class="action-btn" (click)="goToAnalytics()">
          <span class="action-icon">üìä</span>
          –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
        </button>
      </div>
    </div>

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã -->
    <div class="recent-section">
      <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h3>
      <div class="table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>–ö–ª–∏–µ–Ω—Ç</th>
              <th>Email</th>
              <th>–°—É–º–º–∞</th>
              <th>–°—Ç–∞—Ç—É—Å</th>
              <th>–î–∞—Ç–∞</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of recentOrders">
              <td>#{{ order.id }}</td>
              <td>{{ order.customerName }}</td>
              <td>{{ order.customerEmail }}</td>
              <td>{{ formatPrice(order.total) }}</td>
              <td>
                <span class="status-badge" [class]="getStatusClass(order.status)">
                  {{ getStatusText(order.status) }}
                </span>
              </td>
              <td>{{ formatDate(order.date) }}</td>
              <td>
                <button class="btn btn-small" (click)="viewOrderDetails(order)">üëÅÔ∏è</button>
                <select class="status-select" (change)="updateOrderStatus(order, $event)">
                  <option value="pending" [selected]="order.status === 'pending'">–û–∂–∏–¥–∞–µ—Ç</option>
                  <option value="processing" [selected]="order.status === 'processing'">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                  <option value="shipped" [selected]="order.status === 'shipped'">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω</option>
                  <option value="delivered" [selected]="order.status === 'delivered'">–î–æ—Å—Ç–∞–≤–ª–µ–Ω</option>
                  <option value="cancelled" [selected]="order.status === 'cancelled'">–û—Ç–º–µ–Ω–µ–Ω</option>
                </select>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- –ó–∞–∫–∞–∑—ã -->
  <div *ngIf="activeTab === 'orders'" class="tab-content orders-tab">
    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</h2>
    <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</p>
  </div>

  <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
  <div *ngIf="activeTab === 'users'" class="tab-content users-tab">
    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
    
    <div class="table-container">
      <table class="admin-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
            <th>Email</th>
            <th>–†–æ–ª—å</th>
            <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
            <th>–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of recentUsers">
            <td>#{{ user.id }}</td>
            <td>{{ user.username }}</td>
            <td>{{ user.email }}</td>
            <td>
              <span class="role-badge" [class]="getRoleClass(user.role)">
                {{ getRoleText(user.role) }}
              </span>
            </td>
            <td>{{ formatDate(user.registrationDate) }}</td>
            <td>{{ formatDate(user.lastLogin) }}</td>
            <td>
              <button class="btn btn-small" (click)="viewUserDetails(user)">üëÅÔ∏è</button>
                              <select class="role-select" (change)="changeUserRole(user, $event)">
                <option value="user" [selected]="user.role === 'user'">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                <option value="moderator" [selected]="user.role === 'moderator'">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
                <option value="admin" [selected]="user.role === 'admin'">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
              </select>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- –¢–æ–≤–∞—Ä—ã -->
  <div *ngIf="activeTab === 'products'" class="tab-content products-tab">
    <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h2>
    
    <div class="low-stock-section">
      <h3>–¢–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º –∑–∞–ø–∞—Å–æ–º</h3>
      <div class="table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
              <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
              <th>–¢–µ–∫—É—â–∏–π –∑–∞–ø–∞—Å</th>
              <th>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø–∞—Å</th>
              <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let product of lowStockProducts" [class]="product.currentStock === 0 ? 'out-of-stock' : 'low-stock'">
              <td>#{{ product.id }}</td>
              <td>{{ product.name }}</td>
              <td>{{ product.category }}</td>
              <td>
                <span class="stock-badge" [class]="product.currentStock === 0 ? 'stock-empty' : 'stock-low'">
                  {{ product.currentStock }}
                </span>
              </td>
              <td>{{ product.minStock }}</td>
              <td>
                <button class="btn btn-small" (click)="viewProductDetails(product)">üëÅÔ∏è</button>
                <button class="btn btn-small btn-primary" (click)="restockProduct(product)">üì¶</button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
