<!-- Header —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
<app-header></app-header>

<!-- Main Content -->
<main class="main-content">
  <div class="container">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-content">
        <h1 class="hero-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤</h1>
        <p class="hero-subtitle">
          –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –Ω–∞—à —à–∏—Ä–æ–∫–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º 
          –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ –≤—ã–±–æ—Ä–∞
        </p>
      </div>
    </section>

    <!-- Price List Download Section -->
    <section class="price-list-section">
      <div class="price-list-container">
        <div class="price-list-header">
          <h3>üìã –ü—Ä–∞–π—Å-–ª–∏—Å—Ç</h3>
        </div>
        <div class="download-buttons">
          <button class="download-btn pdf-btn" (click)="downloadPriceListPDF()" title="–°–∫–∞—á–∞—Ç—å –ø—Ä–∞–π—Å-–ª–∏—Å—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ PDF">
            <span class="download-icon">üìÑ</span>
            <span class="download-text">PDF</span>
          </button>
        </div>
      </div>
    </section>

    <!-- Filters Section -->
    <section class="filters-section">
      <div class="filters-container">
        <!-- Search -->
        <div class="filter-group">
          <label for="search">–ü–æ–∏—Å–∫:</label>
          <input 
            type="text" 
            id="search" 
            placeholder="–ù–∞–π—Ç–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–ª–∏ —Ç–æ–≤–∞—Ä..."
            [(ngModel)]="searchTerm"
            (input)="onSearchChange()"
            class="search-input"
          >
        </div>

        <!-- Category Filter -->
        <div class="filter-group">
          <label for="category">–§–∏–ª—å—Ç—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π:</label>
          <select 
            id="category" 
            [(ngModel)]="selectedCategory"
            (change)="onCategoryChange()"
            class="category-select"
          >
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option *ngFor="let category of categories" [value]="category.name">
              {{ category.name }}
            </option>
          </select>
        </div>

        <!-- Clear Filters -->
        <div class="filter-group">
          <button class="clear-filters-btn" (click)="clearFilters()">
            –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
          </button>
        </div>
      </div>
    </section>

    <!-- Categories Overview -->
    <section class="categories-overview">
      <!-- Loading state -->
      <div *ngIf="categoriesLoading" class="loading-state">
        <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...</p>
      </div>

      <!-- Error state -->
      <div *ngIf="categoriesError" class="error-state">
        <p>{{ categoriesError }}</p>
        <button (click)="loadCategories()" class="retry-btn">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
      </div>

      <!-- Categories content -->
      <div *ngIf="!categoriesLoading && !categoriesError">
        <div class="section-header">
          <h2>–û–±–∑–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–π</h2>
          <p>–ù–∞–π–¥–µ–Ω–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {{ getFilteredCategories().length }}</p>
        </div>
        
        <div class="categories-grid">
          <div 
            *ngFor="let category of getFilteredCategories()" 
            class="category-card"
          >
            <div 
              class="category-header"
              (click)="goToCategoryProducts(category.id, category.name)"
              style="cursor: pointer;"
              title="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–æ–≤–∞—Ä–∞–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ {{ category.name }}"
            >
              <div class="category-image">
                <img 
                  [src]="getCategoryImage(category)" 
                  [alt]="category.name"
                  (error)="onImageError($event)"
                >
              </div>
              <div class="category-info">
                <h3 class="category-name">{{ category.name }}</h3>
                <div class="category-count">{{ getCategoryProductCount(category) }} —Ç–æ–≤–∞—Ä–æ–≤</div>
              </div>
            </div>

            <!-- –ú–∏–Ω–∏-–∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ -->
            <div *ngIf="searchTerm && getSearchedProductsForCategory(category).length > 0" class="category-products-preview">
              <div class="preview-header">
                <span>–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ getSearchedProductsForCategory(category).length }}</span>
              </div>
              <div class="mini-products-grid">
                <div 
                  *ngFor="let product of getDisplayedProductsForCategory(category)" 
                  class="mini-product-card"
                  (click)="goToProduct(product.id)"
                  title="{{ product.name }}"
                >
                  <div class="mini-product-image">
                    <img 
                      [src]="product.image_url || 'assets/images/placeholder.svg'" 
                      [alt]="product.name"
                      (error)="onImageError($event)"
                    >
                  </div>
                  <div class="mini-product-info">
                    <div class="mini-product-name">{{ product.name }}</div>
                    <div class="mini-product-price">{{ formatPrice(product.price) }}</div>
                  </div>
                </div>
              </div>
              <div 
                *ngIf="getHiddenProductsCount(category) > 0" 
                class="show-more-hint"
                (click)="toggleCategoryExpansion(category.id)"
                [title]="isCategoryExpanded(category.id) ? '–°–≤–µ—Ä–Ω—É—Ç—å —Ç–æ–≤–∞—Ä—ã' : '–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–æ–≤–∞—Ä—ã'"
              >
                <span *ngIf="!isCategoryExpanded(category.id)">
                  +{{ getHiddenProductsCount(category) }} –µ—â—ë...
                </span>
                <span *ngIf="isCategoryExpanded(category.id)">
                  –°–≤–µ—Ä–Ω—É—Ç—å —Ç–æ–≤–∞—Ä—ã
                </span>
              </div>
            </div>

          </div>
        </div>

        <!-- Empty State for All Categories -->
        <div *ngIf="getFilteredCategories().length === 0" class="empty-state">
          <h3>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
          <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
          <button class="clear-filters-btn" (click)="clearFilters()">
            –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
          </button>
        </div>
      </div>
    </section>

  </div>
</main>

<!-- Footer -->
<app-footer></app-footer>
