<!-- Header —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π -->
<app-header></app-header>

<!-- Main Content -->
<main class="main-content">
  <div class="container">
    <!-- Search and Filter Section -->
    <section class="search-filter-section">
      <div class="search-filter-header">
        <h2>–ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è</h2>
        <div class="view-toggle">
          <button 
            [class.active]="viewMode === 'list'"
            (click)="toggleViewMode('list')"
          >
            –°–ø–∏—Å–æ–∫
          </button>
          <button 
            [class.active]="viewMode === 'grid'"
            (click)="toggleViewMode('grid')"
          >
            –°–µ—Ç–∫–∞
          </button>
        </div>
      </div>
      
      <div class="search-filter-content">
        <!-- Search -->
        <div class="search-group">
          <input 
            type="text" 
            placeholder="–ù–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä..."
            [(ngModel)]="searchTerm"
            (input)="onSearchChange()"
            class="search-input"
          >
        </div>

        <!-- Category Filter -->
        <div class="filter-group">
          <label for="category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
          <select 
            id="category" 
            [(ngModel)]="selectedCategory"
            (change)="onCategoryChange()"
            [disabled]="categoriesLoading"
          >
            <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
            <option *ngIf="categoriesLoading" disabled>–ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...</option>
            <option *ngFor="let category of categories" [value]="category.id">
              {{ category.name }}
            </option>
          </select>
        </div>


      </div>
    </section>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading-state">
      <div class="loading-spinner"></div>
      <p>–ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="error-state">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h3>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h3>
      <p>{{ error }}</p>
      <button class="btn btn-primary" (click)="loadProducts()">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>

    <!-- Products Section -->
    <section *ngIf="!loading && !error" class="products-section">
      <div class="products-header" *ngIf="hasActiveFilters">
        <h2>
          –ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: {{ totalProducts }}
          <span *ngIf="selectedCategory" class="category-filter-info">
            –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "{{ getCategoryName(selectedCategory) }}"
          </span>
        </h2>
      </div>
      
      <div class="products-grid" [class.list-view]="viewMode === 'list'">
        <div 
          *ngFor="let product of products" 
          class="product-card"
          [class.out-of-stock]="product.stock === 0"
          (click)="onProductClick($event, product.id)"
          (touchstart)="onProductTouchStart($event)"
          (touchmove)="onProductTouchMove($event)"
          (touchend)="onProductTouchEnd($event, product.id)"
          style="cursor: pointer; -webkit-tap-highlight-color: transparent;"
        >
          <div class="product-image">
            <img 
              [src]="product.image_url || 'assets/images/placeholder.svg'" 
              [alt]="product.name"
              (error)="onImageError($event)"
            >
            <div *ngIf="product.stock === 0" class="out-of-stock-badge">
              –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏
            </div>
            <div *ngIf="product.size" class="size-badge">
              {{ product.size }}
            </div>
          </div>
          
          <div class="product-info">
            <!-- Product Header -->
            <div class="product-header">
              <h3 class="product-title">{{ product.name }}</h3>
              <div class="product-color" *ngIf="product.color">{{ product.color }}</div>
            </div>
            
            <!-- Product Description -->
            <p class="product-description">{{ product.description }}</p>
            
            <!-- Product Specifications -->
            <div class="product-specs">
              <div class="spec-item" *ngIf="product.package_quantity">
                <span class="spec-label">–í —É–ø–∞–∫–æ–≤–∫–µ:</span>
                <span class="spec-value">{{ product.package_quantity }} {{ product.package_quantity_type || '—à—Ç' }}</span>
              </div>
              <div class="spec-item" *ngIf="product.stock > 0">
                <span class="spec-label">–í –Ω–∞–ª–∏—á–∏–∏:</span>
                <span class="spec-value">{{ product.stock }} {{ product.stock_type || '—à—Ç' }}</span>
              </div>
            </div>
            
            <!-- Product Footer -->
            <div class="product-footer">
              <div class="product-price">{{ formatPrice(product.price) }}</div>
              <div class="product-actions">
                <button 
                  class="btn btn-primary"
                  [disabled]="product.stock === 0"
                  (click)="addToCart($event, product)"
                  (touchstart)="onButtonTouchStart($event)"
                  (touchmove)="onButtonTouchMove($event)"
                  (touchend)="onButtonTouchEnd($event, product)"
                  style="-webkit-tap-highlight-color: transparent;"
                >
                  {{ product.stock > 0 ? '–í –∫–æ—Ä–∑–∏–Ω—É' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="products.length === 0 && !loading" class="empty-state">
        <div class="empty-icon">üì¶</div>
        <h3>–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
        <div class="empty-state-actions">
          <button class="btn btn-secondary" (click)="clearFilters()">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
          <button class="btn btn-primary" (click)="goToCategories()">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</button>
        </div>
      </div>

      <!-- Pagination -->
      <div *ngIf="totalPages > 1" class="pagination">
        <!-- Page Info -->
        <div class="page-info">
          {{ pageInfo }}
        </div>

        <!-- Pagination Controls -->
        <div class="pagination-controls">
          <button 
            class="page-btn" 
            [disabled]="currentPage === 1"
            (click)="onPageChange(1)"
            title="–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
          >
            ¬´¬´
          </button>
          
          <button 
            class="page-btn" 
            [disabled]="currentPage === 1"
            (click)="onPageChange(currentPage - 1)"
            title="–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
          >
            ¬´
          </button>
          
          <button 
            *ngFor="let page of pageNumbers"
            class="page-btn"
            [class.active]="page === currentPage"
            (click)="onPageChange(page)"
          >
            {{ page }}
          </button>
          
          <button 
            class="page-btn" 
            [disabled]="currentPage === totalPages"
            (click)="onPageChange(currentPage + 1)"
            title="–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
          >
            ¬ª
          </button>
          
          <button 
            class="page-btn" 
            [disabled]="currentPage === totalPages"
            (click)="onPageChange(totalPages)"
            title="–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
          >
            ¬ª¬ª
          </button>
        </div>
      </div>
    </section>
  </div>
</main>

<!-- Footer -->
<app-footer></app-footer>
